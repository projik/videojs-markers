/*! videojs-markers - v0.5.1 - 2016-09-29
* Copyright (c) 2016 ; Licensed  */
"use strict";!function(a,b,c){function d(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}function e(b){function c(){s.sort(function(a,b){return q.markerTip.time(a)-q.markerTip.time(b)})}function e(b){a.each(b,function(a,b){b.key=d(),t.find(".vjs-progress-control").append(h(b)),r[b.key]=b,s.push(b)}),c()}function g(a){return q.markerTip.time(a)/y*100}function h(b,c){var d=a("<div class='vjs-marker'></div>");return d.css(q.markerStyle).css({"margin-left":-parseFloat(d.css("width"))/2+"px",left:g(b)+"%"}).attr("data-marker-key",b.key).attr("data-marker-time",q.markerTip.time(b)),b.class&&d.addClass(b.class),d.on("click",function(c){var d=!1;if("function"==typeof q.onMarkerClick&&(d=0==q.onMarkerClick(b)),!d){var e=a(this).data("marker-key");v.currentTime(q.markerTip.time(r[e]))}}),q.markerTip.display&&k(d),d}function i(){for(var a=0;a<s.length;a++){var b=s[a],d=t.find(".vjs-marker[data-marker-key='"+b.key+"']"),e=q.markerTip.time(b);d.data("marker-time")!=e&&d.css({left:g(b)+"%"}).attr("data-marker-time",e)}c()}function j(a){x&&(z=-1,x.css("visibility","hidden")),u=-1;for(var b=0;b<a.length;b++){var d=a[b],e=s[d];e&&(delete r[e.key],s[d]=null,t.find(".vjs-marker[data-marker-key='"+e.key+"']").remove())}for(var b=s.length-1;b>=0;b--)null===s[b]&&s.splice(b,1);c()}function k(b){b.on("mouseover",function(){var b=r[a(this).data("marker-key")];w.find(".vjs-tip-inner").text(q.markerTip.text(b)),w.css({left:g(b)+"%","margin-left":-parseFloat(w.css("width"))/2-5+"px",visibility:"visible"})}).on("mouseout",function(){w.css("visibility","hidden")})}function l(){w=a("<div class='vjs-tip'><div class='vjs-tip-arrow'></div><div class='vjs-tip-inner'></div></div>"),t.find(".vjs-progress-control").append(w)}function m(a){if(!(u<0)){var b=s[u],c=q.markerTip.time(b);a>=c&&a<=c+q.breakOverlay.displayTime?(z!=u&&(z=u,x.find(".vjs-break-overlay-text").text(q.breakOverlay.text(b))),x.css("visibility","visible")):(z=-1,x.css("visibility","hidden"))}}function n(){x=a("<div class='vjs-break-overlay'><div class='vjs-break-overlay-text'></div></div>").css(q.breakOverlay.style),t.append(x),z=-1}function o(){var a,c=function(a){return a<s.length-1?q.markerTip.time(s[a+1]):y},d=v.currentTime();if(u!=-1){var e=c(u);if(d>=q.markerTip.time(s[u])&&d<e)return}if(s.length>0&&d<q.markerTip.time(s[0]))a=-1;else for(var f=0;f<s.length;f++)if(e=c(f),d>=q.markerTip.time(s[f])&&d<e){a=f;break}a!=u&&(a!=-1&&b.onMarkerReached&&b.onMarkerReached(s[a]),u=a),q.breakOverlay.display&&m(d)}function p(){q.markerTip.display&&l(),y=b.duration||v.duration(),v.markers.removeAll(),e(b.markers),q.breakOverlay.display&&n(),o(),v.on("timeupdate",o)}var q=a.extend(!0,{},f,b),r={},s=[],t=a(this.el()),u=-1,v=this,w=null,x=null,y=0,z=-1;v.on("loadedmetadata",function(){p()}),v.markers={getMarkers:function(){return s},next:function(){for(var a=v.currentTime(),b=0;b<s.length;b++){var c=q.markerTip.time(s[b]);if(c>a){v.currentTime(c);break}}},prev:function(){for(var a=v.currentTime(),b=s.length-1;b>=0;b--){var c=q.markerTip.time(s[b]);if(c+.5<a){v.currentTime(c);break}}},add:function(a){e(a)},remove:function(a){j(a)},removeAll:function(){for(var a=[],b=0;b<s.length;b++)a.push(b);j(a)},updateTime:function(){i()},reset:function(a){v.markers.removeAll(),e(a)},destroy:function(){v.markers.removeAll(),x.remove(),w.remove(),v.off("timeupdate",m),delete v.markers}}}var f={markerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{display:!0,text:function(a){return a.text},time:function(a){return a.time}},breakOverlay:{display:!1,displayTime:3,text:function(a){return"Break overlay: "+a.overlayText},style:{width:"100%",height:"20%","background-color":"rgba(0,0,0,0.7)",color:"white","font-size":"17px"}},onMarkerClick:function(a){},onMarkerReached:function(a){},markers:[]};b.plugin("markers",e)}(jQuery,window.videojs);